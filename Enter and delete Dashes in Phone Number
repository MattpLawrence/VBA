Private Sub txtSearchPhone_KeyDown(KeyCode As Integer, Shift As Integer)
'Automatically enter dashes into phone number and delete if needed
'Matthew Lawrence 06-22-2021
On Error GoTo ErrorExit

If Len(Me.txtSearchPhone.Text) = 3 Then ' when number of charictors = 3 then add "-"
    Me.txtSearchPhone.Text = Me.txtSearchPhone.Text + "-"
    Me.txtSearchPhone.SelStart = Len(Me.txtSearchPhone.Text) ' set focus back at end of text string
    Me.txtSearchPhone.SetFocus
End If
    If Len(Me.txtSearchPhone.Text) = 7 Then ' when number of charictors = 7 then add "-"
        Me.txtSearchPhone.Text = Me.txtSearchPhone.Text + "-"
        Me.txtSearchPhone.SelStart = Len(Me.txtSearchPhone.Text) ' set focus back at end of text string
        Me.txtSearchPhone.SetFocus
    End If
    
'********************** if backspace is pressed at dashes, delete two characters ********************

If KeyCode = 8 Then 'if enter key is pressed then move the value on, this way the tab event still jumps to next event
    If Len(Me.txtSearchPhone.Text) = 4 Then
      Me.txtSearchPhone.Text = Left(Me.txtSearchPhone.Text, Len(Me.txtSearchPhone.Text) - 2) 'subtract two to get past dashes
      Me.txtSearchPhone.SelStart = Len(Me.txtSearchPhone.Text) ' set focus back at end of text string
      DoCmd.CancelEvent
    Else
        If Len(Me.txtSearchPhone.Text) = 8 Then
            Me.txtSearchPhone.Text = Left(Me.txtSearchPhone.Text, Len(Me.txtSearchPhone.Text) - 2) 'subtract two to get past dashes
            Me.txtSearchPhone.SelStart = Len(Me.txtSearchPhone.Text) ' set focus back at end of text string
            DoCmd.CancelEvent
        End If
            If Len(Me.txtSearchPhone.Text) = 12 Then 'check to see if number is filled
                Exit Sub 'exit so another character doesnt get deleted
            End If
    End If
End If
'************************** limit value to only 12 characters ****************************
If Len(Me.txtSearchPhone.Text) >= 12 Then
    Me.txtSearchPhone.Text = Left(Me.txtSearchPhone.Text, Len(Me.txtSearchPhone.Text) - 1)
    Me.txtSearchPhone.SelStart = Len(Me.txtSearchPhone.Text) ' set focus back at end of text string
End If

Exit Sub

ErrorExit:
Call LogError(Err.Number, Err.Description, "txtSearchPhone_KeyDown", "frmCustomer")
End Sub
